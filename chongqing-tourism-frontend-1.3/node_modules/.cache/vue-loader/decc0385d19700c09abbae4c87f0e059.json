{"remainingRequest":"C:\\Users\\1\\OneDrive\\Desktop\\毕业论文\\chongqing-tourism-frontend-1.3\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\1\\OneDrive\\Desktop\\毕业论文\\chongqing-tourism-frontend-1.3\\src\\components\\Search.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\1\\OneDrive\\Desktop\\毕业论文\\chongqing-tourism-frontend-1.3\\src\\components\\Search.vue","mtime":1709623442912},{"path":"C:\\Users\\1\\OneDrive\\Desktop\\毕业论文\\chongqing-tourism-frontend-1.3\\node_modules\\css-loader\\index.js","mtime":1709363803486},{"path":"C:\\Users\\1\\OneDrive\\Desktop\\毕业论文\\chongqing-tourism-frontend-1.3\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1709363801943},{"path":"C:\\Users\\1\\OneDrive\\Desktop\\毕业论文\\chongqing-tourism-frontend-1.3\\node_modules\\postcss-loader\\src\\index.js","mtime":1709363806597},{"path":"C:\\Users\\1\\OneDrive\\Desktop\\毕业论文\\chongqing-tourism-frontend-1.3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709363805293},{"path":"C:\\Users\\1\\OneDrive\\Desktop\\毕业论文\\chongqing-tourism-frontend-1.3\\node_modules\\vue-loader\\lib\\index.js","mtime":1709363801915}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t#container {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t\theight: 100%;\nz-index: 1;\n\t}\n\n\t#myPageTop {\n\n\t\tposition: absolute;\n\t\ttop: 10px;\n\t\tright: 10px;\n\t\tbackground-color: white;\n\t\tborder-radius: 5px;\n\t\tbox-shadow: rgba(0, 0, 0, 0.24) 0px 3px 5px;\n\t\tz-index: 2;\n\n\t}\n\n\t/* 添加一个样式用于 infoWindow 的内容 */\n\t.info-window-content {\n\t\tpadding: 10px;\n\t}\n",{"version":3,"sources":["Search.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoOA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA","file":"Search.vue","sourceRoot":"src/components","sourcesContent":["//Search.vue\r\n\r\n<template>\r\n\t<div id=\"container\">\r\n\t\t<div id=\"myPageTop\">\r\n\t\t\t<table>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<label style=\"font-size: 14px;\">请输入要搜索的地点：</label>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<el-input v-model=\"input\" id=\"tipinput\"></el-input>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport AMapLoader from \"@amap/amap-jsapi-loader\";\r\n\timport axios from \"axios\";\r\n\texport default {\r\n\t\tprops: {\r\n\t\t\toptimizedPath: {\r\n\t\t\t\ttype: Array,\r\n\t\t\t\tdefault: () => [],\r\n\t\t\t},\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tmap: null,\r\n\t\t\t\tinfoWindow: null,\r\n\t\t\t\titineraryPoints: [],\r\n\t\t\t\tdrivingList: [], // 存储多个 AMap.Driving 对象\r\n\r\n\t\t\t};\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.initMap();\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\toptimizedPath: {\r\n\t\t\t\thandler: 'handleOptimizedPathChange',\r\n\t\t\t\timmediate: true, // 立即执行一次\r\n\t\t\t},\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\thandleOptimizedPathChange(newPath) {\r\n\t\t\t\tconsole.log('optimizedPath 发生变化（Search.vue）:', newPath);\r\n\t\t\t\tconsole.log(\"行程点数组:\", this.itineraryPoints);\r\n\t\t\t\tAMapLoader.load({\r\n\t\t\t\t\tkey: \"177f68d7bc584a174470beca1681ae92\",\r\n\t\t\t\t\tversion: \"2.0\",\r\n\t\t\t\t\tplugins: [\r\n\t\t\t\t\t\t\"AMap.Driving\"\r\n\t\t\t\t\t],\r\n\t\t\t\t}).then((AMap) => {\r\n\t\t\t\t\t// 清除之前的路线\r\n\t\t\t\t\tthis.clearPreviousRoutes();\r\n\t\t\t\t\tthis.clearMarkers();\r\n\t\t\t\t\tconsole.log(\"新路径长度:\", newPath.length);\r\n\t\t\t\t\t// 使用 AMap.Driving 服务规划路线\r\n\t\t\t\t\tfor (let i = 0; i < newPath.length - 1; i++) {\r\n\t\t\t\t\t\tconst startIdx = newPath[i];\r\n\t\t\t\t\t\tconst endIdx = newPath[i + 1];\r\n\t\t\t\t\t\t// console.log(\"行程点数组:\", this.itineraryPoints);\r\n\t\t\t\t\t\t// 从经纬度对象中获取经纬度值\r\n\t\t\t\t\t\tconst startLngLat = [\r\n\t\t\t\t\t\t\tthis.itineraryPoints[startIdx].position.lng,\r\n\t\t\t\t\t\t\tthis.itineraryPoints[startIdx].position.lat,\r\n\t\t\t\t\t\t];\r\n\t\t\t\t\t\tconst endLngLat = [\r\n\t\t\t\t\t\t\tthis.itineraryPoints[endIdx].position.lng,\r\n\t\t\t\t\t\t\tthis.itineraryPoints[endIdx].position.lat,\r\n\t\t\t\t\t\t];\r\n\r\n\t\t\t\t\t\tconst driving = new AMap.Driving({\r\n\t\t\t\t\t\t\tmap: this.map,\r\n\t\t\t\t\t\t\tautoFitView: false,\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// 将 driving 对象存储在数组中\r\n\t\t\t\t\t\tthis.drivingList.push(driving);\r\n\r\n\t\t\t\t\t\t// 执行路径规划\r\n\t\t\t\t\t\tdriving.search(startLngLat, endLngLat, (status, result) => {\r\n\t\t\t\t\t\t\tif (status === \"complete\" && result.routes && result.routes.length) {\r\n\t\t\t\t\t\t\t\tconsole.log(`绘制驾车路线完成 (${startIdx} to ${endIdx})`);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconsole.error(\r\n\t\t\t\t\t\t\t\t\t`获取驾车数据失败 (${startIdx} to ${endIdx}):`,\r\n\t\t\t\t\t\t\t\t\tresult\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tinitMap() {\r\n\t\t\t\tAMapLoader.load({\r\n\t\t\t\t\tkey: \"177f68d7bc584a174470beca1681ae92\",\r\n\t\t\t\t\tversion: \"2.0\",\r\n\t\t\t\t\tplugins: [\r\n\t\t\t\t\t\t\"AMap.PlaceSearch\",\r\n\t\t\t\t\t\t\"AMap.AutoComplete\",\r\n\t\t\t\t\t\t\"AMap.Scale\",\r\n\t\t\t\t\t\t\"AMap.ControlBar\",\r\n\t\t\t\t\t\t\"AMap.MapType\",\r\n\t\t\t\t\t\t\"AMap.Driving\"\r\n\r\n\t\t\t\t\t],\r\n\t\t\t\t}).then((AMap) => {\r\n\t\t\t\t\tthis.map = new AMap.Map(\"container\", {\r\n\t\t\t\t\t\tresizeEnable: true,\r\n\t\t\t\t\t\tzoom: 10,\r\n\t\t\t\t\t\tcenter: [106.551643, 29.562849],\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tthis.map.addControl(new AMap.Scale());\r\n\t\t\t\t\tthis.map.addControl(\r\n\t\t\t\t\t\tnew AMap.ControlBar({\r\n\t\t\t\t\t\t\tposition: {\r\n\t\t\t\t\t\t\t\ttop: \"10px\",\r\n\t\t\t\t\t\t\t\tleft: \"10px\",\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.map.addControl(\r\n\t\t\t\t\t\tnew AMap.MapType({\r\n\t\t\t\t\t\t\tposition: {\r\n\t\t\t\t\t\t\t\tbottom: \"108px\",\r\n\t\t\t\t\t\t\t\tright: \"10px\",\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tvar autoOptions = {\r\n\t\t\t\t\t\tinput: \"tipinput\",\r\n\t\t\t\t\t\tcity: \"023\",\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tvar auto = new AMap.AutoComplete(autoOptions);\r\n\t\t\t\t\tvar placeSearch = new AMap.PlaceSearch({\r\n\t\t\t\t\t\tmap: this.map,\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tauto.on(\"select\", (e) => {\r\n\t\t\t\t\t\tthis.map.setFitView();\r\n\t\t\t\t\t\tplaceSearch.setCity(e.poi.adcode);\r\n\t\t\t\t\t\tplaceSearch.search(e.poi.name);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 创建信息窗体\r\n\t\t\t\t\tthis.infoWindow = new AMap.InfoWindow({\r\n\t\t\t\t\t\tisCustom: true,\r\n\t\t\t\t\t\toffset: new AMap.Pixel(0, -30),\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 监听地图点击事件\r\n\t\t\t\t\tplaceSearch.on(\"markerClick\", (event) => {\r\n\t\t\t\t\t\tconst marker = event.marker;\r\n\t\t\t\t\t\tthis.openInfoWindow(event);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tclearPreviousRoutes() {\r\n\t\t\t\t// 清除之前的路线\r\n\t\t\t\tfor (const driving of this.drivingList) {\r\n\t\t\t\t\tdriving.clear();\r\n\t\t\t\t}\r\n\t\t\t\t// 重置数组\r\n\t\t\t\tthis.drivingList = [];\r\n\t\t\t},\r\n\t\t\tclearMarkers() {\r\n\t\t\t\t// 清除地图上的Marker\r\n\t\t\t\tthis.map.clearMap();\r\n\t\t\t},\r\n\t\t\topenInfoWindow(event) {\r\n\t\t\t\tconst marker = event.marker;\r\n\t\t\t\tconst position = marker.getPosition();\r\n\t\t\t\tconst marker_name = event.data.name;\r\n\t\t\t\tconst marker_address = event.data.address;\r\n\r\n\t\t\t\t// 使用原生 HTML+CSS 创建 InfoWindow 内容\r\n\t\t\t\tlet info = [];\r\n\t\t\t\tinfo.push(\"<div class='info-window-content'>\");\r\n\t\t\t\tinfo.push(`<p><strong>名称：</strong>${marker_name}</p>`);\r\n\t\t\t\tinfo.push(`<p><strong>地址：</strong>${marker_address}</p>`);\r\n\t\t\t\tinfo.push(`<button onclick='sendMessage(${position.lng}, ${position.lat})'>添加至行程</button>`);\r\n\t\t\t\tinfo.push(\"</div>\");\r\n\r\n\t\t\t\tthis.infoWindow = new AMap.InfoWindow({\r\n\t\t\t\t\tcontent: info.join(\"\"), // 使用默认信息窗体框样式，显示信息内容\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// 将 sendMessage 方法绑定到 window 对象中\r\n\t\t\t\twindow.sendMessage = (lng, lat) => {\r\n\t\t\t\t\tthis.addToItinerary({\r\n\t\t\t\t\t\tposition: {\r\n\t\t\t\t\t\t\tlng: lng,\r\n\t\t\t\t\t\t\tlat: lat,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tname: marker_name,\r\n\t\t\t\t\t\taddress: marker_address,\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.infoWindow.open(this.map, position);\r\n\t\t\t},\r\n\t\t\taddToItinerary(data) {\r\n\t\t\t\t// 添加到itineraryPoints\r\n\t\t\t\tthis.itineraryPoints.push(data);\r\n\t\t\t\tconsole.log(\"行程点数组:\", this.itineraryPoints);\r\n\r\n\t\t\t\t// 关闭信息窗体\r\n\t\t\t\tthis.infoWindow.close();\r\n\t\t\t\tthis.$emit(\"itinerary-updated\", this.itineraryPoints);\r\n\t\t\t},\r\n\r\n\t\t},\r\n\t};\r\n</script>\r\n\r\n<style>\r\n\t#container {\r\n\t\tposition: relative;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\nz-index: 1;\r\n\t}\r\n\r\n\t#myPageTop {\r\n\r\n\t\tposition: absolute;\r\n\t\ttop: 10px;\r\n\t\tright: 10px;\r\n\t\tbackground-color: white;\r\n\t\tborder-radius: 5px;\r\n\t\tbox-shadow: rgba(0, 0, 0, 0.24) 0px 3px 5px;\r\n\t\tz-index: 2;\r\n\r\n\t}\r\n\r\n\t/* 添加一个样式用于 infoWindow 的内容 */\r\n\t.info-window-content {\r\n\t\tpadding: 10px;\r\n\t}\r\n</style>"]}]}